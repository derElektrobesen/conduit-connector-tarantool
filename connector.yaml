version: "1.0"
specification:
  name: tarantool
  summary: A Conduit Connector for Tarantool
  description: |-
    A destination connector for [Tarantool](https://www.tarantool.io).

    Source connector isn't implemented yet.
  version: v0.0.1
  author: Pavel Berezhnoy
  destination:
    parameters:
      - name: collection.*.sharding_key
        description: |-
          sharding_key specifies a field used to calculate bucket ID.
          Key could be a text template or a static value.
          Static value could be used if there is only one tarantool shard
          present.

          See [Referencing record fields](https://conduit.io/docs/using/processors/referencing-fields)
          for more info.
        type: string
        default: ""
        validations:
          - type: required
            value: ""
      - name: password
        description: password specifies a password to access tarantool.
        type: string
        default: ""
        validations:
          - type: required
            value: ""
      - name: replicasets
        description: |-
          replicasets specifies tarantool cluster configuration

          Example configuration:

            replicasets: |-

              - name: "replicaset_1"                             # required

                uuid: "ff69c808-039f-4478-9f28-27a487b3d1d3"     # required

                replicas:                                        # *required*

                  - addr: "127.0.0.1:1001"                       # *required*

                    name: "1_1"                                  # optional

                    uuid: "15299fc8-fb53-44dc-9a84-2332fad9687c" # required

                  - addr: "127.0.0.1:1002"

                    name: "1_2"

                    uuid: "15299fc8-fb53-44dc-9a84-2332fad9687c"

              - name: "replicaset_2"

                uuid: "29bbdcc4-2aa8-475f-b660-4fdc20dd5052"

                replicas:

                  - addr: "127.0.0.1:1003"

                    name: "2_1"

                  - addr: "127.0.0.1:1004"

                    name: "2_2"
        type: string
        default: ""
        validations:
          - type: required
            value: ""
      - name: total_buckets
        description: total_buckets specifies a number of buckets in tarantool cluster.
        type: int
        default: ""
        validations:
          - type: required
            value: ""
          - type: greater-than
            value: "0"
      - name: user
        description: user specifies username to access tarantool.
        type: string
        default: ""
        validations:
          - type: required
            value: ""
      - name: shard_function
        description: |-
          shard_function specifies a shard function to be used during sharding.
          At now only default sharding function is supported.
        type: string
        default: default
        validations:
          - type: inclusion
            value: default
      - name: sdk.batch.delay
        description: Maximum delay before an incomplete batch is written to the destination.
        type: duration
        default: "0"
        validations: []
      - name: sdk.batch.size
        description: Maximum size of batch before it gets written to the destination.
        type: int
        default: "0"
        validations:
          - type: greater-than
            value: "-1"
      - name: sdk.rate.burst
        description: |-
          Allow bursts of at most X records (0 or less means that bursts are not
          limited). Only takes effect if a rate limit per second is set. Note that
          if `sdk.batch.size` is bigger than `sdk.rate.burst`, the effective batch
          size will be equal to `sdk.rate.burst`.
        type: int
        default: "0"
        validations:
          - type: greater-than
            value: "-1"
      - name: sdk.rate.perSecond
        description: Maximum number of records written per second (0 means no rate limit).
        type: float
        default: "0"
        validations:
          - type: greater-than
            value: "-1"
      - name: sdk.record.format
        description: |-
          The format of the output record. See the Conduit documentation for a full
          list of supported formats (https://conduit.io/docs/using/connectors/configuration-parameters/output-format).
        type: string
        default: opencdc/json
        validations: []
      - name: sdk.record.format.options
        description: |-
          Options to configure the chosen output record format. Options are normally
          key=value pairs separated with comma (e.g. opt1=val2,opt2=val2), except
          for the `template` record format, where options are a Go template.
        type: string
        default: ""
        validations: []
      - name: sdk.schema.extract.key.enabled
        description: Whether to extract and decode the record key with a schema.
        type: bool
        default: "true"
        validations: []
      - name: sdk.schema.extract.payload.enabled
        description: Whether to extract and decode the record payload with a schema.
        type: bool
        default: "true"
        validations: []
